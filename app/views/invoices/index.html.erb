<%= form_tag invoices_path, :method => 'get' do %>
<div class="row">
  <div class="col-sm-3">

    <div class="search_invoice_form">
      <div id="short_search_invoice_form">
        <%= hidden_field_tag :direction, params[:direction] %>
        <%= hidden_field_tag :sort, params[:sort] %>
        <%= label_tag :date, "Data wystawienia faktury" %>
        <div class='input-group date' id='datetimepicker1' data-date-format="yyyy-mm-dd" locale="pl">
          <%= text_field_tag :date %>
          <span class="input-group-addon">
            <span class="glyphicon glyphicon-calendar"></span>
          </span>
        </div>
        <a href="" id="advanced_search_button">Zaawansowane wyszukiwanie</a>
      </div>

      <div id="advanced_search_invoice_form">
        <%= label_tag :date_start, "Od" %>
        <div class='input-group date' id='datetimepicker1' data-date-format="yyyy-mm-dd" locale="pl">
          <%= text_field_tag :date_start %>
          <span class="input-group-addon">
            <span class="glyphicon glyphicon-calendar"></span>
          </span>
        </div>

        <%= label_tag :date_stop, "Do" %>
        <div class='input-group date' id='datetimepicker1' data-date-format="yyyy-mm-dd" locale="pl">
          <%= text_field_tag :date_stop %>
          <span class="input-group-addon">
            <span class="glyphicon glyphicon-calendar"></span>
          </span>
        </div>

        <%= label_tag :client_name, "Nazwa klienta" %>
        <div>
          <%= text_field_tag :client_name %>
        </div>
      </div>
      <%= submit_tag "Search", :date => nil, :client_name => nil %>
      <a href="" id="reset_search_button">Resetuj</a>
      <br>
      <%= link_to 'New Invoice', new_invoice_path, class: "button-success" %>
    </div>
  </div>
  <div class="col-sm-9">
    <h1>Listing invoices</h1>

    <% end %>

    <table class="table">
      <thead>
        <tr>
          <th></th>
          <th>Numer</th>
          <th><%= sortable "net_price_cents", "Wartość netto" %></th>
          <th><%= sortable "total_selling_price_cents", "Wartość brutto" %></th>
          <th><%= sortable "clients.name", "Klient" %></th>
          <th><%= sortable "date", "Data wystawienia" %></th>
          <th>Produkty</th>
          <th><%= sortable "status", "Status" %></th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        <% @invoices.each do |invoice| %>
        <tr>
          <td></td>
          <td><%= link_to invoice.invoice_name.get_name, invoice %></td>
          <td><%= link_to "#{humanized_money_with_symbol invoice.net_price}", invoice %></td>
          <td><%= link_to "#{humanized_money_with_symbol invoice.total_selling_price}", invoice %></td>
          <td><%= link_to invoice.client.name, invoice.client %></td>
          <td><%= link_to invoice.date.strftime('%F'), invoice %></td>
          <td>
            <% invoice.items.each do |product| %>
              <%= product.name %>
            <% end %>
          </td>
          <td>
            <div class="btn-group invoice-status" invoice-id="<%= invoice.id %>">
              <% button_status_class = "btn-status-#{invoice.status}" %>
              <button type="button" class="btn <%= button_status_class %> status" data-toggle="dropdown"><%= invoice.status_name %></button>
              <button type="button" class="btn <%= button_status_class %> dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" invoice-id="<%= invoice.id %>">
                <li><a class="invoice_option" href="#" value="1">wystawiona</a></li>
                <li><a class="invoice_option" href="#" value="2">wysłana</a></li>
                <li><a class="invoice_option" href="#" value="3">zapłacona</a></li>
              </ul>
          </div>
          </td>
          <td>
            <div class="btn-group invoice-status" invoice-id="<%= invoice.id %>">
              <button type="button" class="btn btn-secondary" data-toggle="dropdown"><span class="glyphicon glyphicon-cog"></span></button>
              <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li><%= link_to 'Show', invoice %></li>
                <li><%= link_to 'Edit', edit_invoice_path(invoice) %></li>
                <li><%= link_to 'Destroy', invoice, method: :delete, data: { confirm: 'Are you sure?' } %></li>
              </ul>
          </td>
        </tr>
        <% end %>
      </tbody>
    </table>
    <%= will_paginate @posts %>
    <br>
  </div>
</div>
